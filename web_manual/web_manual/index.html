<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Grid Move Console</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="bg-shapes"></div>

    <main class="wrap">
      <header class="hero panel">
        <div class="hero-text">
          <p class="eyebrow">Robot Manual</p>
          <h1>Grid Move Console</h1>
          <p class="subtitle">
            Điều khiển robot theo hướng robot hoặc theo tọa độ bản đồ (VDA5050)
          </p>
        </div>

        <div class="status-card">
          <div class="status-line">
            <span>MQTT</span>
            <span id="statusConn">waiting</span>
          </div>
          <div class="status-line">
            <span>Pose (map)</span>
            <span id="statusPose">n/a</span>
          </div>
        </div>
      </header>

      <section class="grid-panel panel">
        <div class="canvas-shell">
          <canvas id="grid"></canvas>
        </div>

        <div class="grid-meta">
          <div class="metric">
            <span class="label">Target</span>
            <span id="targetReadout">x=0.00, y=0.00</span>
          </div>
          <div class="metric">
            <span class="label">Distance</span>
            <span id="distReadout">0.00 m</span>
          </div>
          <div class="metric">
            <span class="label">Angle</span>
            <span id="angleReadout">0.0 deg</span>
          </div>
          <div class="metric">
            <span class="label">End Theta</span>
            <span id="thetaReadout">0.0 deg</span>
          </div>
        </div>
      </section>

      <aside class="controls panel">
        <div class="card">
          <h2>Move Mode</h2>
          <div class="field-row">
            <label for="modeSelect">Chế độ di chuyển</label>
            <select id="modeSelect">
              <option value="robot">Robot frame (x=right, y=forward)</option>
              <option value="map">Map frame (absolute map X/Y)</option>
            </select>
          </div>
          <p class="note">
            Robot frame: dịch chuyển tương đối theo hướng robot.<br />
            Map frame: robot đi tới tọa độ tuyệt đối trên bản đồ.
          </p>
        </div>

        <div class="card">
          <h2>Target</h2>

          <div class="field-row">
            <label for="xInput">X (m, right +)</label>
            <input id="xInput" type="number" step="0.01" value="0" />
          </div>

          <div class="field-row">
            <label for="yInput">Y (m, forward +)</label>
            <input id="yInput" type="number" step="0.01" value="0" />
          </div>

          <div class="field-row">
            <label for="distInput">Distance (m)</label>
            <input id="distInput" type="number" step="0.01" value="0" />
          </div>

          <div class="field-row">
            <label for="angleInput">Angle (deg, 0 fwd, +right)</label>
            <input id="angleInput" type="number" step="0.1" value="0" />
          </div>

          <p class="note">
            Click vào grid để chọn nhanh vector di chuyển.<br />
            Distance + Angle dùng cho cả 2 mode.
          </p>
        </div>

        <div class="card">
          <h2>Grid Scale</h2>
          <div class="field-row">
            <label for="scaleInput">Meters per grid</label>
            <input id="scaleInput" type="number" step="0.1" value="0.5" min="0.1" />
          </div>
          <div class="scale-buttons">
            <button id="zoomIn">Zoom In</button>
            <button id="zoomOut">Zoom Out</button>
          </div>
        </div>

        <div class="card">
          <h2>Orientation</h2>

          <div class="field-row">
            <label for="rotateSelect">Start rotateDirection</label>
            <select id="rotateSelect">
              <option value="ROTATE_SELF">ROTATE_SELF</option>
              <option value="ROTATE_CLOCKWISE">ROTATE_CLOCKWISE</option>
              <option value="ROTATE_COUNTERCLOCKWISE">ROTATE_COUNTERCLOCKWISE</option>
            </select>
          </div>

          <div class="field-row">
            <label for="thetaOverrideInput">End theta override (deg, 0=forward)</label>
            <input id="thetaOverrideInput" type="number" step="0.1" placeholder="auto" />
          </div>

          <p class="note">Để trống = end theta tự động theo vector di chuyển.</p>
        </div>

        <!-- SEND -->
        <div class="card">
          <h2>Send</h2>

          <div class="toggle-row">
            <label class="toggle">
              <input id="reverseToggle" type="checkbox" />
              <span>Tail-first (reverse)</span>
            </label>
            <span class="toggle-hint">Robot chạy lùi, edge orientation = π</span>
          </div>

          <div class="actions">
            <button id="sendBtn" class="primary">Send Move</button>
            <button id="recenterBtn" class="ghost">Re-center</button>
            <button id="clearBtn" class="ghost">Clear</button>
            <button id="cancelBtn" class="ghost">Cancel</button>
          </div>

          <div id="result" class="result">Idle</div>
        </div>
      </aside>
    </main>

    <script src="app.js"></script>
  </body>
</html>
